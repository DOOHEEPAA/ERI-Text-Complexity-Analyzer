# ERI 텍스트 복잡도 분석기 (ERI Text Complexity Analyzer for Korean)

## 1. 개요 (Overview)

이 프로젝트는 한국어 텍스트의 가독성 및 복잡도를 측정하는 **ERI(Explainable Readability Index, 설명 가능한 가독성 지수)**를 계산하는 Python 스크립트입니다.

ERI 지수는 다음과 같은 두 가지 평가를 종합하여 산출됩니다.
1.  **양적 평가**: 어휘 수준(쉬운 어휘, 어려운 어휘), 문장 구조의 복잡성 등 텍스트의 언어학적 특징을 계량적으로 분석합니다.
2.  **질적 평가**: 양적 평가만으로는 측정하기 어려운 내용의 추상성, 배경지식의 요구 수준 등을 평가자가 직접 점수(-3 ~ +3)로 입력합니다.

최종 ERI 지수는 **`양적 평가 점수 + 질적 평가 점수`** 로 계산되어, 텍스트의 난이도를 종합적으로 판단하는 데 도움을 줍니다.

## 2. 주요 기능 (Features)

* **어휘 수준 분석**: 국립국어원의 한국어 기초 어휘 등급 목록을 기반으로 쉬운 어휘(A등급)와 어려운 어휘(C등급 외)의 사용 빈도를 측정합니다.
* **문장 복잡도 분석**: 문장 내 절(clause)의 개수, 수식 구조, 내포 구조 등을 분석하여 문장의 구조적 복잡도를 점수화합니다.
* **자동 표본 추출**: 긴 지문의 경우, 분석 효율을 위해 지문의 시작, 중간, 끝 부분에서 텍스트를 자동으로 샘플링합니다.
* **질적 평가 GUI**: `Tkinter`를 활용한 그래픽 사용자 인터페이스(GUI)를 제공하여 평가자가 편리하게 질적 평가 점수를 입력할 수 있습니다.
* **상세 결과 리포트**: 모든 분석 결과(양적/질적 평가 점수, 최종 지수, 사용된 어휘 목록 등)를 서식이 지정된 깔끔한 Excel 파일로 저장합니다.

## 3. 설치 및 준비 사항 (Prerequisites)

### 3.1. 필요 라이브러리 설치

Python 3.11.7 버전이 필요합니다. 다음 명령어를 사용하여 필요한 라이브러리를 설치하세요.

```bash
pip install pandas kiwipiepy openpyxl
```

* `pandas`: 데이터 처리 및 Excel 파일 생성을 위해 사용됩니다.
* `kiwipiepy`: 한국어 형태소 분석을 위해 사용됩니다.
* `openpyxl`: Excel 파일의 스타일(너비, 정렬, 폰트 등)을 수정하기 위해 사용됩니다.
* `tkinter`: Python 표준 라이브러리로, 별도의 설치가 필요 없을 수 있습니다. (설치 필요 시: `sudo apt-get install python3-tk` on Debian/Ubuntu, `brew install python-tk` on macOS)

### 3.2. 필요 파일 준비

스크립트를 실행하기 전에, 다음 두 개의 파일을 스크립트와 **동일한 폴더**에 위치시켜야 합니다.

1.  **어휘 등급 목록 (`붙임1_★최종 공개용_국어 기초 어휘 선정 및 어휘 등급화 목록 전체.xlsx`)**
    * 국립국어원에서 제공하는 어휘 등급 목록 엑셀 파일입니다.
    * 스크립트는 이 파일의 `"전체(1~5등급), 40,000개"` 시트를 읽어 어휘의 난이도를 판단합니다.
    * 어휘 등급표 공식 다운로드 링크: https://www.korean.go.kr/front/reportData/reportDataView.do?mn_id=207&report_seq=1160

2.  **분석 대상 텍스트 (`지문모음.txt`)**
    * 분석하고자 하는 텍스트를 모아놓은 `utf-8` 인코딩의 텍스트 파일입니다.
    * 파일 내용은 아래와 같은 **`지문명:내용`** 형식으로 작성해야 합니다.
    * 지문의 내용이 여러 줄에 걸쳐 있어도 자동으로 인식합니다.

    ```
    (예시) 지문모음.txt

    제주 민요의 구성과 의미: 제주도는 그 지리적 특성과 역사적 배경으로 인해 독자적인 민속문화를 발전시켜 왔다. 특히 민요는 제주인의 삶과
                            정서를 담아내는 대표적인 구술 예술 형태로, 노동의 리듬을 맞추거나 신앙적 행위와 결합하여 공동체의 유대감을 형성하는 데 기여해 왔다. 제주 민요는 일반적으로 정형화된 형식을 따르기보다는, 구전되는 과정에서 자연스럽게 변형되며 지역성과 발화자의 개성을 반영한다.
                            제주 민요는 그 기능에 따라 ‘일노래’, ‘의식요’, ‘유희요’ 등으로 분류된다. ‘일노래’는 밭일, 고기잡이, 김 매기 등 노동 과정에서 부르는 노래로, 일정한 박자와 후렴이 반복되어 노동의 지루함을 해소하고 공동작업의 일체감을 조성한다. 예를 들어, ‘해녀노래’는 물질의 고단함을 달래기 위한 정서적 도구로 사용되며, 바다에 대한 공경과 해녀 공동체의 연대감을 상징한다.
                            ‘의식요’는 마을굿, 제례 등 종교적 의식에서 불리며, 신과의 소통 수단이자 공동체의 안녕을 기원하는 정서적 매개체 역할을 한다. 이들 민요는 독특한 선율과 억양으로 신비감을 부여하며, 청중의 몰입을 유도한다. ‘유희요’는 오락적 성격이 강하며, 주로 놀이·잔치 또는 일을 마친 뒤 휴식 자리에서 흥을 돋우기 위해 불리는 노래로, 해학과 풍자가 녹아 있어 제주인의 유머 감각과 현실 인식이 반영되어 있다.
                            제주 민요는 제주어 특유의 억양과 발음을 고스란히 담고 있으며, 이는 제주 지역의 방언 보존과도 밀접한 관련이 있다. 또한 민요에 담긴 시어와 비유는 단순한 언어 표현을 넘어, 공동체의 삶의 방식과 세계관을 암시하는 문화적 코드로 작용한다. 예컨대, 자연물에 의인화된 표현은 인간과 자연이 긴밀히 상호작용해 온 제주인의 생태적 감수성을 반영한다.
                            오늘날 제주 민요는 공연예술로서의 가치뿐 아니라 문화유산으로서의 중요성도 재조명되고 있다. 다만, 전승의 위기는 여전히 존재하며, 이를 해결하기 위해 지역 사회의 적극적인 관심과 함께 교육·연구·보존을 위한 제도적 노력이 절실하다. 제주 민요는 단순한 음악을 넘어, 섬이라는 공간 속에서 축적된 집단기억이자 정체성의 발현이라 할 수 있다.

    ```

## 4. 사용 방법 (How to Use)

1.  위 `3. 설치 및 준비 사항`에 따라 라이브러리를 설치하고 필요한 파일 2개를 준비합니다.
2.  터미널 또는 명령 프롬프트에서 스크립트가 있는 폴더로 이동합니다.
3.  다음 명령어를 입력하여 스크립트를 실행합니다.
    ```bash
    python "text complexity calculation.py"
    ```
4.  터미널에 각 지문의 **양적 평가**가 완료되었다는 메시지가 출력될 때까지 기다립니다.
5.  **'질적평가 점수 입력'** GUI 창이 나타나면, 각 지문별로 -3에서 3 사이의 **질적 평가 점수**를 입력합니다. (입력하지 않으면 0점으로 처리됩니다.)
6.  점수 입력을 마친 후 **`확인`** 버튼을 클릭합니다.
7.  스크립트 실행이 완료되면, 동일 폴더에 **`ERI_지문별_최종분석결과.xlsx`** 파일이 생성됩니다. 이 파일을 열어 상세 분석 결과를 확인합니다.

## 5. 결과 파일 설명 (Output Description)

생성된 Excel 파일에는 다음과 같은 정보가 포함됩니다.

| 컬럼명 | 설명 |
| :--- | :--- |
| **지문명** | `지문모음.txt`에 명시된 각 지문의 이름입니다. |
| **문장수** | 분석에 사용된 표본 텍스트의 문장 개수입니다. |
| **표본텍스트** | 실제 분석에 사용된 텍스트 (지문이 길 경우 샘플링됨) |
| **K_avg(문장복잡도)** | 문장의 평균적인 구조적 복잡도 점수입니다. 높을수록 복잡합니다. |
| **X2(A등급 어휘 개수)** | 표본 텍스트에 사용된 쉬운 어휘(1~3등급)의 고유한 개수입니다. |
| **Z(C등급 외 어휘 개수)** | 표본 텍스트에 사용된 어려운 어휘(사전에 없는 어휘)의 고유한 개수입니다. |
| **A등급 어휘** | 표본 텍스트에서 발견된 A등급 어휘 목록입니다. |
| **C등급 외 어휘** | 표본 텍스트에서 발견된 C등급 외 어휘 목록입니다. |
| **ERI_양적평가** | K_avg, X2, Z 값을 공식에 대입하여 계산된 텍스트의 객관적 난이도 점수입니다. |
| **ERI_질적평가** | 평가자가 GUI를 통해 직접 입력한 주관적 난이도 점수입니다. |
| **ERI_최종지수** | `양적평가 + 질적평가`로 계산된 최종 텍스트 복잡도 지수입니다. **(핵심 결과)** |
